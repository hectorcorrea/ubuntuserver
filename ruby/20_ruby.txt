# Install Ruby from source (via ruby-install)
#
# Reference: http://ryanbigg.com/2014/10/ubuntu-ruby-ruby-install-chruby-and-you/

# Download Ubuntu tools
sudo apt-get install build-essential
sudo apt-get install libgdbm-dev libtinfo-dev libncurses5-dev libreadline6-dev libreadline-dev


# Install ruby-install
cd
wget -O ruby-install-0.5.0.tar.gz https://github.com/postmodern/ruby-install/archive/v0.5.0.tar.gz
tar -xzvf ruby-install-0.5.0.tar.gz
cd ruby-install-0.5.0/
sudo make install

ruby-install -V


# Install Ruby. This takes a while.
ruby-install ruby 2.2.0


# Install chruby
#
# Reference: https://github.com/postmodern/chruby
#
# Download and install chruby
cd
wget -O chruby-0.3.9.tar.gz https://github.com/postmodern/chruby/archive/v0.3.9.tar.gz
tar -xzvf chruby-0.3.9.tar.gz
cd chruby-0.3.9/
sudo make install


# To set a default ruby when logging in
# add this to ~/.bashrc
#
# chruby.sh sets the path and environment variables
# requried by ruby like GEM_ROOT and GEM_PATH
source /usr/local/share/chruby/chruby.sh
chruby 2.2.0


## Not sure I need any of this...

# if you have many versions of Ruby on the server
# and want to automatically switch to a specific
# version by project you an also source auto.sh
# add this to ~/.bashrc
source /usr/local/share/chruby/auto.sh


# To set a default version of ruby, create ~/.ruby-version
# this only works if you use auto.sh (see above)
echo "ruby-2.2.0" > ~/.ruby-version


# Enable chruby system-wide
# Create file /etc/profile.d/chruby.sh with the following:
#
# This does NOT enable it for root in the init scripts
#
if [ -n "$BASH_VERSION" ] || [ -n "$ZSH_VERSION" ]; then
  source /usr/local/share/chruby/chruby.sh
  chruby 2.2.0
fi
